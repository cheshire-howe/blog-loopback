!function(){"use strict";function a(a,b){function c(){a.isCollapsed=!0}function d(){f.userId=localStorage.getItem("$LoopBack$currentUserId")?localStorage.getItem("$LoopBack$currentUserId"):"",a.isLoggedIn=f.userId?!0:!1}function e(){var a={filter:{include:{relation:"user",scope:{fields:["username"]}}}};b.find(a).$promise.then(function(a){f.posts=a})}var f=this;f.userId="",f.posts=[],f.collapse=c,d(),e()}function b(a,b,c){function d(){f.userId=localStorage.getItem("$LoopBack$currentUserId")?localStorage.getItem("$LoopBack$currentUserId"):"",a.isLoggedIn=f.userId?!0:!1}function e(){f.newPost.userId=f.userId,c.create(f.newPost).$promise.then(function(){f.postForm.$setPristine(),b.go("blog")})}var f=this;f.userId="",f.addPost=e,f.newPost=f.newPost||{},d()}function c(a,b,c,d,e,f){function g(){j.userId=localStorage.getItem("$LoopBack$currentUserId")?localStorage.getItem("$LoopBack$currentUserId"):"",a.isLoggedIn=j.userId?!0:!1}function h(){var a={filter:{where:{id:b.id},include:{relation:"user",scope:{fields:["username"]}}}};return d.findOne(a)}function i(){d.comments.destroyAll({id:j.post.id}).$promise.then(function(){f.posts.destroyById({id:j.userId,fk:j.post.id}).$promise.then(function(){c.go("blog")})})}c.transitionTo("postDetail.comments",b);var j=this;j.userId="",j.post=h(),j.deletePost=i,g()}function d(a,b,c,d,e,f){function g(){j.userId=localStorage.getItem("$LoopBack$currentUserId")?localStorage.getItem("$LoopBack$currentUserId"):"",a.isLoggedIn=j.userId?!0:!1}function h(){return e.get({id:c.id})}function i(a){f.posts.updateById({id:j.userId,fk:c.id},{title:a.title,content:a.content}).$promise.then(function(){d.go("postDetail",{id:c.id})})}var j=this;j.userId="",j.newPost=h(),j.editPost=i,g()}var e=angular.module("blogApp.controllers.postCtrls",["lbServices"]);e.controller("PostCtrl",a),a.$inject=["$rootScope","Post","User"],e.controller("PostCreateCtrl",b),b.$inject=["$rootScope","$state","Post","User"],e.controller("PostDetailCtrl",c),c.$inject=["$rootScope","$stateParams","$state","Post","Comment","User"],e.controller("PostEditCtrl",d),d.$inject=["$rootScope","$scope","$stateParams","$state","Post","User"]}();