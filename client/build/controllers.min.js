"use strict";var blogControllers=angular.module("blogControllers",[]);blogControllers.controller("PostCtrl",["$rootScope","$scope","Post","User",function(a,b,c,d){d.getCurrent().$promise.then(function(){a.isLoggedIn=!0},function(){a.isLoggedIn=!1}),b.collapse=function(){a.isCollapsed=!0},b.posts=[],c.find().$promise.then(function(a){b.posts=a})}]),blogControllers.controller("PostCreateCtrl",["$rootScope","$scope","$state","Post","User",function(a,b,c,d,e){e.getCurrent().$promise.then(function(c){a.isLoggedIn=!0,b.userId=c.id},function(){a.isLoggedIn=!1}),b.addPost=function(){b.newPost.userId=b.userId,d.create(b.newPost).$promise.then(function(){b.postForm.$setPristine(),c.go("blog")})}}]),blogControllers.controller("PostDetailCtrl",["$rootScope","$scope","$stateParams","$state","Post","User",function(a,b,c,d,e,f){function g(){b.comments=e.prototype$__get__comments({id:c.id})}f.getCurrent().$promise.then(function(c){a.isLoggedIn=!0,b.userId=c.id},function(){a.isLoggedIn=!1}),b.post=e.get({id:c.id}),g(),b.deletePost=function(a){e.deleteById({id:a}).$promise.then(function(){d.go("blog")})},b.addComment=function(){e.prototype$__create__comments({id:b.post.id},{content:b.newComment.content,userId:b.userId}).$promise.then(function(){b.newComment="",b.commentForm.$setPristine(),g()})},b.editComment=function(a,c){e.prototype$__updateById__comments({fk:c,id:b.post.id},{content:a,userId:b.userId})},b.deleteComment=function(a){e.prototype$__destroyById__comments({fk:a,id:b.post.id}).$promise.then(function(){g()})}}]),blogControllers.controller("PostEditCtrl",["$rootScope","$scope","$stateParams","$state","Post","User",function(a,b,c,d,e,f){f.getCurrent().$promise.then(function(c){a.isLoggedIn=!0,b.userId=c.id},function(){a.isLoggedIn=!1}),b.newPost=e.get({id:c.id}),b.editPost=function(){b.newPost.$save(function(){d.go("postDetail",{id:c.id})})}}]),blogControllers.controller("UserRegisterCtrl",["$rootScope","$scope","$state","User",function(a,b,c,d){d.getCurrent().$promise.then(function(d){a.isLoggedIn=!0,b.userId=d.id,c.go("blog")},function(){a.isLoggedIn=!1}),b.register=function(){var a={email:b.newUser.email,password:b.newUser.password};d.create(a).$promise.then(function(){d.login(a,function(){c.go("blog")})})}}]),blogControllers.controller("UserLoginCtrl",["$rootScope","$scope","$state","User",function(a,b,c,d){d.getCurrent().$promise.then(function(d){a.isLoggedIn=!0,b.userId=d.id,c.go("blog")},function(){a.isLoggedIn=!1}),b.login=function(){d.login({email:b.user.email,password:b.user.password}).$promise.then(function(){b.loginFail=!1,a.isLoggedIn=!0,c.go("blog")},function(){b.loginFail=!0})}}]),blogControllers.controller("UserLogoutCtrl",["$rootScope","$state","User",function(a,b,c){c.logout().$promise.then(function(){a.isLoggedIn=!1,b.go("blog")})}]);